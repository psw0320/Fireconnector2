<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>URL Chat</title>
<style>
body { font-family: Arial; max-width: 500px; margin: auto; }
#chat { border: 1px solid #ccc; height: 300px; overflow-y: auto; padding: 10px; }
.msg { margin: 5px 0; }
input { width: 80%; padding: 5px; }
button { padding: 5px; }
</style>
</head>
<body>

<h2>ðŸ”— Serverless URL Messenger</h2>

<div id="chat"></div>
<input id="input" placeholder="ë©”ì‹œì§€ ìž…ë ¥..." />
<button onclick="send()">ì „ì†¡</button>

<script>
let messages = [];

// base64 ì¸ì½”ë”©
function encode(data) {
    return btoa(unescape(encodeURIComponent(JSON.stringify(data))));
}

// base64 ë””ì½”ë”©
function decode(data) {
    return JSON.parse(decodeURIComponent(escape(atob(data))));
}

// URLì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
function loadFromURL() {
    if (location.hash.length > 1) {
        try {
            messages = decode(location.hash.substring(1));
        } catch {
            messages = [];
        }
    }
    render();
}

// URLì— ì €ìž¥
function saveToURL() {
    location.hash = encode(messages);
}

// í™”ë©´ ì¶œë ¥
function render() {
    const chat = document.getElementById("chat");
    chat.innerHTML = "";
    messages.forEach(msg => {
        const div = document.createElement("div");
        div.className = "msg";
        div.textContent = msg;
        chat.appendChild(div);
    });
    chat.scrollTop = chat.scrollHeight;
}

// ë©”ì‹œì§€ ì „ì†¡
function send() {
    const input = document.getElementById("input");
    if (input.value.trim() === "") return;
    messages.push(input.value);
    input.value = "";
    saveToURL();
    render();
}

loadFromURL();
</script>

</body>
</html>
